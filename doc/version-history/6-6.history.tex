%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\label{sec:History-6-6}Stable Release Series 6.6}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This is a stable release series of Condor.
It is based on the 6.5 development series.
All new features added or bugs fixed in the 6.5 series are available
in the 6.6 series.
The details of each version are described below.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\label{sec:New-6-6-12}Version 6.6.12}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Contains only a couple bug fixes.

\end{itemize}

%\noindent New Features:
%
%\begin{itemize}
%
%\item None.
%
%\end{itemize}

\noindent Bugs fixed that are included in version 6.7.19:

\begin{itemize}

\item None.

\end{itemize}


\noindent Bugs fixes irrelevant to the 6.7 series:

\begin{itemize}

\item Fixed a bug which caused the \Condor{collector} incorrectly
  handle Collector ads in which the \AdAttr{Machine} attribute is
  missing, or Storage ads in which the \AdAttr{Name} is missing.  In
  these cases, a \Condor{collector} running on some platforms
  (notably, Solaris) could crash.

\end{itemize}


\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-6-11}Version 6.6.11}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item A security team at UW-Madison is conducting an onging security
audit of the Condor system and has identified a few important
vulnerabilities.
Condor versions 6.6.11 and 6.7.18 fix these security problems and
other bugs.
There have been no reported exploits, but all sites are urged to
upgrade immediately.

The Condor Team will publish detailed reports of these vulnerabilities
on 2006-04-24, 4 weeks from the date when the fixes were first
released (2006-03-27).
This will allow all sites time to upgrade before enough information to
exploit these bugs is widely available.

\end{itemize}

%\noindent New Features:
%
%\begin{itemize}
%
%\item None.
%
%\end{itemize}

\noindent Security Bugs Fixed:

\begin{itemize}

\item Bugs in previous versions of Condor could allow any user who can
submit jobs on a machine to gain access to the ``condor'' account
(or whatever non-privileged user the Condor daemons are running as).
This bug can not be exploited remotely, only by users already logged
onto a submit machine in the Condor pool.

\item The security of the ``\condor{config\_val} -set'' feature was
found to be insufficient, so this feature is now disabled by default.
There are new configuration settings to enable this feature in a
secure manner.
Please read the descriptions of \Macro{ENABLE\_RUNTIME\_CONFIG},
\Macro{ENABLE\_PERSISTENT\_CONFIG} and \Macro{PERSISTENT\_CONFIG\_DIR}
in the example configuration file shipped with the latest Condor
releases, or in section~\ref{param:EnableRuntimeConfig} on
page~\pageref{param:EnableRuntimeConfig}. 

\end{itemize}


\noindent Other bugs fixed that are included in version 6.7.18:

\begin{itemize}

% gnats PR #646
\item Fixed a bug which could cause the \Condor{collector} to crash
  when it receives certain types of malformed ads.

\item Fixed a bug which caused the \Condor{collector} incorrectly
  handle ads in which the \AdAttr{UpdateInterval} attribute is set.
  In particular, the previous versions of the \Condor{collector} will
  use the \AdAttr{UpdateInterval} value as the maximum \Term{lifetime}
  of the ad when aging the ads, which could cause it to remove the ad
  prematurely.
  The \Condor{collector} now looks at the \AdAttr{ClassAdLifetime}
  attribute, and uses its value (if set).
  \Note No current Condor daemons are publishing either of these
  attributes, but may do so in the future.

\end{itemize}

\noindent Bugs fixed that are included in version 6.7.14:

\begin{itemize}

\item Fixed a rare problem in the \Condor{negotiator} where a poorly
  formed classad from a single \Condor{schedd} could halt negotiation
  for the entire pool.
  This poorly formed ad could only happen in extrememly rare
  circumstances, but it was possible.
  Now, the \Condor{negotiator} will simply ignore poorly formed
  classads and continue to negotiate with any other \Condor{schedd} in
  the system that has idle jobs.

\item Fixed a bug which caused log messages which should contain
  ``PRIV\_USER\_FINAL'' to be ``PRIV\_USER\_FINALPRIV\_FILE\_OWNER''.
  It's also possible that this same bug could cause crashes if any
  daemon attempts to log a message which would refer to
  ``PRIV\_FILE\_OWNER''.

\item Fixed a bug which caused the \Condor{starter} to exit with an
  error when the sum total of the file transfer size exceeded 2G.
  This, in turn, caused a ``shadow exeception'', and the job would
  fail.

\end{itemize}


\noindent Bugs fixed that are included in version 6.7.11:

\begin{itemize}

\item In very rare cases, the \Condor{startd} could get into an
infinite loop if a job it was managing was suspended and then there
were fatal errors trying to send commands to evict the corresponding
\Condor{starter}.
This bug has been fixed, and the \Condor{startd} will now correctly
recover (and cleanup all processes) if it fails to send commands to a
starter managing a suspended job.

\item Condor on Solaris has been patched to work around a Solaris stdio
limitation of 255 maximum file descriptors.  Before this patch, heavily
loaded Condor daemons running on Solaris, particularly the \Condor{schedd},
could exit complaining about lack of file descriptors for dprintf.

\item Fixed a bug where the \Condor{starter} would follow symbolic links to
directories, when calculating job disk usage.  This could cause an incorrect
job disk usage calculation, or hang the starter upon encountering an infinite
directory loop.  This bug only affected Unix platforms.

\item For Globus jobs, the Rematch expression is now evaluated when a
submit fails (in addition to when a submit commit times out).

\item Fixed a bug that caused the \Condor{gridmanager} to go into an
infinite loop if an entry in the job's environment string was missing
an equals sign.

\end{itemize}

\noindent Bugs fixed that are included in version 6.7.9:

\begin{itemize}

\item Fixed a bug where the \Condor{startd} would erroneously compute the 
console idle time utilizing a file called /proc/interrupts on unix machines
that were not linux. 

\item Fixed a bug where the \Condor{negotiator} might dump core if it was
reconfiged in the middle of a negotiation cycle.

\item Fixed a bug where the \Condor{negotiator} might dump core if a startd
had a name longer than 63 bytes. 

\item Fixed a bug that could cause \Condor{userprio} to crash if the
data it gets back from the \Condor{negotiator} is invalid.

\item Fixed a bug where
\Macro{DEFAULT\_PRIO\_FACTOR} was ignored if 
\Macro{ACCOUNTANT\_LOCAL\_DOMAIN} was not defined.

\end{itemize}

\noindent Bugs fixes irrelevant to the 6.7 series:

\begin{itemize}

\item Added the \Opt{-NoEventChecks} and the \Opt{-AllowLogError}
command-line flags to \Condor{submit\_dag} and the \Condor{submit\_dag}
man page (they were already in \Condor{dagman}).
Added \Opt{-r} and \Opt{-debug} to the \Condor{submit\_dag}
man page (they were already in \Condor{submit\_dag}, just not
documented).

\item Made command-line arguments case insensitive in the Windows
version of \Condor{submit\_dag}; also fixed log file checks in
that version.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item A bug has been found which can cause a \Condor{collector} to
  crash on some platforms (notably, Solaris).  This can happen if the
  \Condor{collector} receives a Collector ad in which the
  \AdAttr{Machine} attribute is missing, or a Storage ad in which the
  \AdAttr{Name} is missing.  There is no security threat involved in
  either case.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-6-10}Version 6.6.10}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Most of the fixes included in this release were also included in
  version 6.7.7 (see below).

\item The \MacroNI{QUEUE\_CLEAN\_INTERVAL} timer is reset during a 
\Condor{schedd} reconfig only if this timer value has been changed.
Previously, the timer was reset during all \Condor{schedd} reconfigs, which
could prevent the \File{job\_queue.log} file from being cleaned.  Note that
this timer is always reset upon a \Condor{schedd} startup.  See the
related change for truncating the \File{job\_queue.log} below, for this same
release.

\item Previously, the \Condor{schedd} would over-react and exit if it
tried to send a user email and \MacroNI{SMTP\_SERVER} was undefined;
now it simply prints an error in the SchedLog and moves on.

\end{itemize}

%\noindent New Features:
%
%\begin{itemize}
%
%\item None.
%
%\end{itemize}

\noindent Bugs fixed that are included in version 6.7.7:

\begin{itemize}

\item Fixed a bug that could cause the file \File{job\_queue.log} in
	the Condor SPOOL directory to grow unnecessarily large, thereby
	slowing down the startup and/or shutdown times for the \Condor{schedd}
	daemon.

\item Fixed a critical bug where the console idle time for PS/2 keyboards
	and mice was not being updated correctly.

\item Fixed a bug in the \Condor{collector} that could cause it to
crash when parsing certain types of invalid ClassAds.  In particular, if
a Machine, Schedd or License ClassAd sent to the \Condor{collector} has
an IP address field which is empty (which should never happen), the
\Condor{collector} will crash.

\item Fixed some bugs in how the \Condor{schedd} handles a graceful
  shutdown (either because of a \Condor{off}) or a \verb@SIGTERM@ on
  UNIX): 
\begin{itemize}
  \item There was a minor bug if \Macro{JOB\_START\_DELAY} was set to
     0 that would prevent the \Condor{schedd} from correctly cleaning
     up during graceful shutdown.
     Now, the \Condor{schedd} will properly shutdown, even if
     \MacroNI{JOB\_START\_DELAY} is set to 0.

  \item Fixed a bug when there are scheduler universe jobs that were
    recently submitted to the queue.
    Previously, the shutdown code would not evict scheduler universe
    jobs that had been submitted since the last
    \Macro{SCHEDD\_INTERVAL} (which defaults to 5 minutes).
    So, if a user submitted a scheduler universe job and then someone
    shutdown Condor on that machine, the \Condor{schedd} would wait
    until the next \MacroNI{SCHEDD\_INTERVAL} had elapsed before
    evicting the job.
    Now, the schedd will always attempt to evict scheduler universe
    jobs during a shutdown, without waiting for this interval to pass.
\end{itemize}

\item A number of Windows-specific bugs were fixed:
\begin{itemize}
  \item It was possible under certain circumstances for execute
  directories to not be cleaned up properly. This has been fixed.

  \item Certain Asian locales would cause the \Condor{starter} to crash
  due to character translation problems. This has been fixed.

  \item Condor will now properly report memory sizes that exceed 2 GB.

  \item The \Condor{starter} would be unable to run jobs if the \verb@LOG@
  path had a period (.) in it. This has been fixed.

  \item The \Condor{startd} would leak memory, especially on SMP
  machines. This has been fixed.

  \item The \Condor{master} would crash immediately on Windows 2003
  Server if the firewall was enabled. This has been fixed.

\end{itemize}

% See Gnats PR 479. 
\item Fixed a bug in \Condor{dagman} that could cause \Condor{dagman}
to fail an assertion if PRE or POST scripts are throttled with the
\Opt{-maxpre} or \Opt{-maxpost} \Condor{submit\_dag} command line flags.

\end{itemize}

\noindent Bugs fixed that are NOT included in version 6.7.7:

\begin{itemize}

\item Fixed a bug where enabling the grid\_monitor for any globus
job handled by something other than a hard-coded list of jobmanager names
would cause the job to stay idle forever.  The hard-coded list of
jobmanager names was: condor, fork, lsf, pbs, and remote.  A jobmanager
by any other name (e.g. condor\_rh9, or lcgpbs) would cause the problem.
This bug was originally fixed in internal releases of 6.7.0, but it was
reintroduced by mistake in all public releases.

\item Fix the way \Condor{version} handles command line arguments
  (there were a number of problems and inconsistencies) and added a
  \Opt{-help} option and usage message.

\item Fixed some memory leaks in the \Condor{startd} that would be
induced by calling \Condor{reconfig} or \Condor{status} \Opt{-d}.

\item By design, Condor daemons will exit if their parent process
exits. On Windows, a bug introduced in v6.5.x series broke this
behavior. This is now fixed.

\item On Windows, users would often observe the \Condor{master} failing to
add exceptions for the Condor daemons to the Windows Firewall on Windows
XP SP2 or Windows 2003 Server SP1. The \Condor{master} will
now retry for a longer period of time to add these exceptions,
and the number of retries has now been made configurable. See
section~\ref{param:WindowsFirewallFailureRetry} on
page~\pageref{param:WindowsFirewallFailureRetry} for more information.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-6-9}Version 6.6.9}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Most of the fixes included in this release were also included in
  version 6.7.5.
  However, at the end of this section, a few fixes that were added to
  6.6.9 after 6.7.5 was released are mentioned separately.

\end{itemize}

%\noindent New Features:
%
%\begin{itemize}
%
%\item None.
%
%\end{itemize}

\noindent Bugs fixed that are included in version 6.7.5:

\begin{itemize}

\item Fixed a security bug in the \Condor{schedd} that could enable a
maliciously modified \Condor{submit} tool to overwrite files in the Condor
\Macro{SPOOL} subdirectory, including the job queue.

\item Fixed a bug where under very pathological file permission failure
conditions with a standard universe job, there would be a cycle of an
execute event followed by a termination event in the user log when the
job had not actually ran.


\end{itemize}

\noindent Bugs fixed that are NOT included in version 6.7.5:

\begin{itemize}

\item Fixed a memory management bug introduced in version 6.6.8 that
  could result in deallocated memory being referenced after a child
  process forked from a Condor daemon exits.

\item Fixed bugs in some Condor tools that failed to locate
  \Condor{startd} daemons that contained multiple \verb&@& signs in
  their \Attr{Name} attribute.
  For example, a virtual machine from a multiple-CPU \Condor{startd}
  spawned using glidein would have the name:
  \verb&vm1@[pid]@[hostname]&.
  All Condor tools that need to communicate with a \Condor{startd}
  like this will now succeed.

\item Removed a fixed-length buffer in the code that handled the
  \MacroNI{SUBSYS\_EXPRS} config file setting.
  Previously, if any attributes referred to were larger than
  approximate 1000 bytes, Condor daemons would crash.
  Now, there is no limit to the size of the attributes listed in 
  \MacroNI{SUBSYS\_EXPRS}.
  For more information about this setting, see
  section~\ref{param:SubsysExprs} on page~\pageref{param:SubsysExprs}.

\item Fixed a bug which would cause Condor to fail to cache user GID
information and potentially overwhelm NIS servers.

\item Fixed another bug which could cause UDP machine updates to be
dropped by the \Condor{collector}.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item If a DAG node has both retries and a POST script, and the
actual Condor job for the node fails, the POST script is not
run except after the last retry of the job (or if the job
succeeds).  (The POST script should be run each time the node
job is run, whether the job succeeds or not.)

\item Occasionally, Condor generates both a terminated event and
an aborted event for a job that is aborted.  If this happens for a
DAG node job, \Condor{dagman} considers this an error
and aborts the DAG.  If you run into this problem, you can avoid
the abort by adding the \Opt{-NoEventChecks} flag to argument list
in the \Condor{dagman} submit file generated by \Condor{submit\_dag}
(you have to do \Condor{submit\_dag} \Arg{-no\_submit} and hand-edit
the resulting submit file).  However, if you get the
double events on a node that has retries, \Condor{dagman} will assert.
The only fix for this is to upgrade to a 6.7.5 or newer \Condor{dagman}.
You can do this by simply installing a newer \Condor{dagman} executable,
without any other changes to your Condor installation.  It is fine to
run a 6.7 \Condor{dagman} on a 6.6 Condor installation.

\item \item In a DAG, if a node job generates an executable error event,
the DAG is aborted.  This can be worked around by adding the
\Opt{-NoEventChecks} flag to argument list in the \Condor{dagman}
submit file generated by \Condor{submit\_dag} (you have to do
\Condor{submit\_dag} \Arg{-no\_submit} and hand-edit the resulting
submit file).

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-6-8}Version 6.6.8}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Most of the fixes included in this release were also included in
  version 6.7.3.
  However, at the end of this section, a few fixes that were added to
  6.6.8 after 6.7.3 was released are mentioned separately.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item None.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item In version 6.6.7, we fixed bugs related to the
  \Opt{-format} option to various Condor tools.
  However, some sites were using \Opt{-format} in ways we did not
  expect, by not specifying any '%' conversion string in the format
  string at all.
  This used to work, given the old buggy code that handled
  \Opt{-format}, but the changes in version 6.6.7 broke this, and
  format strings without a '%' conversion string were ignored.
  Now, if the format string does not contain a '%' conversion string,
  the attribute name which follows it is once again ignored, and the
  format string is printed directly without any modification.
  For example, to print out the machine's \Attr{Name} (always defined)
  and the \Attr{RemoteUser} (only defined if the machine is claimed),
  and always print a newline (to keep the formatting legible), this
  command will now work:
\begin{verbatim}
% condor_status -f "%s " Name -f "%s " RemoteUser -f "\n" bogus
bird.cs.wisc.edu biguser@raven.cs.wisc.edu
condor.cs.wisc.edu
dodo.cs.wisc.edu biguser@raven.cs.wisc.edu
lark.cs.wisc.edu biguser@raven.cs.wisc.edu
raven.cs.wisc.edu
...
\end{verbatim}

\item Windows bug fixes:
\begin{itemize}

\item Fixed a bug in that would cause Condor to fail to gracefully
shutdown user jobs that are console applications (including batch
scripts).

\item Fixed an issue that would cause \Condor{store\_cred} to fail
if the user did not have \verb@NETWORK@ logon rights.

\item \Condor{store\_cred} \Opt{query} command would appear to succeed,
even if the stored credential was invalid (e.g. the password was changed
but the password stash was not updated). This has been fixed.


\item Fixed a bug that would cause the \Condor{startd} to crash under
certain conditions during job eviction. This bug was introduced in Condor
version 6.6.6.

\item Fixed a bug that would cause \Condor{dagman} to crash if it was
submitted as a non-Administrator user.

\item Fixed a bug that would cause Condor to occasionally kill processes
that didn't belong to it during job eviction or daemon restarts.

\item On startup, the \Condor{master} would occasionally fail to add the
daemons to the Windows XP firewall exception list because of a race with
the Windows SharedAccess service. This bug has been fixed.

\item If a user submitted a job with an invalid executable, the starter
would often wedge until the job was preempted. Now, the starter attempts
to detect invalid executables and prevent wedging.

\item Fixed issues that would cause \Condor{startd} to ``disappear''
from the pool because of dropped machine ad updates. This fix applies
to all platforms, but the symptoms were exhibited predominantly on
Windows machines.

\item Fixed a bug that could cause \Macro{HIGHPORT} and
\Macro{LOWPORT} parameters to be ignored if a Windows machine ran for
several weeks without being rebooted.

\end{itemize}

\item Starting with RedHat 9, newer versions of Linux began to produce
  core files named \File{core.<pid>}.
  This broke functionality in Condor that managed and transferred back
  any core file created by the job, since the \Condor{starter} was
  unable to locate the proper file.
  Now, Condor will correctly transfer back core files, even if they
  are created as \File{core.<pid>}.
  This functionality works in all universes, and is independent of
  Condor's file transfer mechanism.


\item Fixed a bug that was causing \Condor{startd} to consume large
amounts of memory over long periods of time.

\item Fixed a bug that was causing \Condor{startd} to fail to start up
with the message, "caInsert: Can't insert CpuBusy into target ClassAd."

\item Fixed a long-standing bug in Condor regarding the configuration
  settings \Macro{LOWPORT} and \Macro{HIGHPORT}.
  When these were enabled (to restrict Condor's port usage to a
  specified range), Condor would fail to set the
  \texttt{SO\_KEEPALIVE} option on sockets it created.
  This meant that in the case of a hard machine failure (such as a
  sudden power outage, etc) on one machine, Condor daemons
  communicating with that machine would never notice it had died.
  Now, the \texttt{SO\_KEEPALIVE} option is properly set on all
  sockets, even with \MacroNI{LOWPORT} and \MacroNI{HIGHPORT}
  defined. 

\item Fixed a bug that caused \Condor{rm} \Opt{-forcex} to not remove
  jobs that make use of \AdAttr{leave\_in\_queue}.
  If invoked using a cluster id, username, or constraint expression,
  \Condor{rm} would report success but the jobs would remain in the queue.
  Now, the jobs will leave the queue.

\item When a held job is released, job ad attributes HoldReasonCode and
  HoldReasonSubCode are now properly moved to LastHoldReasonCode and
  LastHoldReasonSubCode.

\item Fixed a bug that would cause the \Attr{RemoveReason} attribute
  for a job 
  to be set incorrectly in some circumstances.
  Specifically, this was when a job
  was not running and a \AdAttr{periodic\_remove} expression
  caused the job to be cancelled.

\item Fixed \Condor{submit} such that submit description file
  commands written with syntax both of
  \verb@ThisStyle@ and \verb@this_style@ will work.

\item Fixed a very rare but serious bug in Condor that was originally
  introduced in version 6.3.0.
  Under exceptional circumstances (a very heavily loaded machine where
  a huge number of processes are being spawned all the time, and where
  the \Condor{schedd} is managing many thousands of jobs in the
  queue), it was possible for the \Condor{schedd} to run a job twice.
  We have fixed the underlying problem that lead to the
  \Condor{schedd} making this mistake, rendering this error
  impossible.

\item Fixed a bug that occurred when submitted Condor-G jobs while
  using the grid monitor. If the grid job monitor returned a FAILED
  status for a job while the jobmanager is asleep, the \Condor{gridmanager}
  could sometimes end up in a loop, continuously restarting the remote
  Globus jobmanager then putting it back to sleep.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None

\end{itemize}

\noindent Bugs fixed that are not included in version 6.7.3:

\begin{itemize}

\item Fixed a discrepancy in the \MacroNI{SUBSYS\_ADDRESS\_FILE}
  setting.
  Previously, this setting did not work for \MacroNI{SUBSYS} values of
  \ShortExpr{COLLECTOR} or \ShortExpr{NEGOTIATOR} (for example, defining
  \MacroNI{COLLECTOR\_ADDRESS\_FILE} had no effect).
  Now, if either of these is defined in the configuration file,
  the corresponding Condor daemon will write out the address
  and port it is using to the specified file.
  Normally, the \Condor{collector} and \Condor{negotiator} listen on a
  well-known, fixed port.
  However, on single-machine, Personal Condor installations,
  these address files allow all of the Condor daemons and tools to locate
  the \Condor{collector} and \Condor{negotiator}, even if they are
  using a dynamically assigned port.
  For more information about the \MacroNI{SUBSYS\_ADDRESS\_FILE}
  setting, please see the description in
  section~\ref{param:SubsysAddressFile} on
  page~\pageref{param:SubsysAddressFile}.
  For more information about using non-standard ports for the
  \Condor{collector} and \Condor{negotiator}, please see the
  description of ``Non Standard Ports for Central Managers'' in
  section~\ref{sec:Ports-NonStandard} on
  page~\pageref{sec:Ports-NonStandard}.

\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-6-7}Version 6.6.7}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item None.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item Added a feature to the \Condor{master} which automatically adds
the Condor daemons to the Windows Firewall exception list. This only
applies to machines running Windows XP SP2.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug specific to Windows that could cause, in rare occurrences
due to a race condition, Condor to fail to properly signal the job to
suspend, continue, or preempt.

\item When Condor transfers the job executable using the file transfer
  mechanism, it used to leave the binary sitting as a world-writable
  file inside the execute directory on UNIX.
  Now, executable files transferred by Condor have the proper
  permissions (mode 0755).

\item Fixed an important bug in the low-level code that Condor uses to
  transfer files across a network.
  There were certain temporary failure cases that were being treated
  as permanent, fatal errors.
  This resulted in file transfers that aborted prematurely, causing
  jobs to needlessly re-run.
  The code now gracefully recovers from these temporary errors.
  This should significantly help throughput for some sites,
  particularly ones that transfer very large files as output from
  their jobs.
 
\item Fixed a bug in the file transfer mechanism which caused
  segmentation faults when very long input/output/intermediate file
  lists were used.

\item Fixed a number of bugs in the \Opt{-format} option to \Condor{q}
  and \Condor{status}.
  Now, these tools will properly handle printing boolean expressions
  in all cases.
  Previously, depending on how the boolean evaluated, either the
  expression was printed, or the tool could crash.
  Furthermore, the tools do a better job of handling the different 
  types of format conversion strings and printing out the appropriate
  value.
  For example, if a user tries to print out a boolean attribute with
  \verb@condor_status -format "%d\n" HasFileTransfer@, the
  \Condor{status} tool will evaluate \Attr{HasFiletransfer} and print
  either a 0 or a 1 (FALSE or TRUE).
  If, on the other hand, a user tries to print out a boolean attribute
  with \verb@condor_status -format "%s\n" HasFileTransfer@, the
  \Condor{status} tool will print out the string ``FALSE'' or ``TRUE''
  as appropriate.

\item The ClassAd attribute scope resolution prefixes, \texttt{MY.} and
\texttt{TARGET.}, are no longer case sensitive.

\item \Condor{dagman} now generates a fatal error if any node submit
files are missing the log file attribute.  This behavior can be
overridden with the \Opt{-AllowLogError} command-line option.

\item \Condor{dagman} now does better checking for inconsistent events
(such as getting multiple terminate events for a single job).  This
checking can be disabled with the \Opt{-NoEventChecks} command-line
option.

\item Under Tru64, Condor would sometimes fail to start a job while
	setting the resource limits on behalf of the job.
	This error appears to be the result of a kernel issue.
	A workaround has been implemented which will leave the limits
	of the job unmodified and run the job when this specific error
	situation arises.

\item On Windows, occasionally Condor would exhibit erratic behavior
when a machine resumes from sleeping. This has been fixed.

\item On Windows, occasionally Condor would fail to bind to any available
interfaces due to a mishandling of a function return value. This has
been fixed.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-6-6}Version 6.6.6}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item A \Condor{dagman} job will fail and report a cycle in the DAG
when XML logs are used in a single or multiple log format. The Post
Script  completion event does not get converted to XML and Dagman
never sees them complete or fail because of the format of the event.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item The checkpoint server has moved from contrib module status to being
	a normal part of Condor.

\item When the first start running, all Condor daemons will now try to
  print to their log file the full path to the binary they are
  executing. 
  Unfortunately, we can only reliably get this information on Linux,
  Solaris, MacOSX, and Windows platforms.
  On other platforms, this information will only be printed to the log
  file in certain cases that depend on how the daemon was invoked.
  This new feature was added to aid in debugging problems where sites
  were not running the version of the Condor daemons they thought they
  were due to problems in custom-built startup scripts.
 
\item \Condor{wait} is now available in the Windows port.

\item Added a fix to the accountant that allows users to specify user 
	priorities with \Condor{userprio} before any jobs have been submitted. 

\item Added support for running batch files under Windows when using the
	\Macro{STARTD\_CRON} or \Macro{USER\_JOB\_WRAPPER} attributes.

\item Moved from Globus 2.2.2 to Globus 2.2.4 for Condor-G, except for 
	the DUX 4.0f platform.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Windows bug fixes:
\begin{itemize}
  \item Fixed a bug which could cause Condor to kill processes that
    aren't related to Condor or the job it was running at the time.

  \item Fixed a problem that could cause daemons or tools to crash
    when they looked up information about processes running on the
    system.

  \item Fixed a problem with the collector dropping TCP updates with
    pools larger than roughly 20 machines. This issue only occurs with
    \Macro{UPDATE\_COLLECTOR\_WITH\_TCP} enabled.

  \item Fixed an issue with \Condor{store\_cred} reporting success when
   in fact under certain circumstances the store command actually failed.

  \item Removed \Condor{kbdd\_dll}. It is no longer used.

  \item Fixed an issue with \Condor{birdwatcher} that caused it to
    leak resource handles.

  \item Fixed an issue with the Windows port of \Condor{dagman} that
    would cause it to crash when POST scripts were used.

\end{itemize}

\item Fixed a bug where the environment of jobs in any universe could
  be corrupted.

\item The \Condor{startd} now properly cleans up execute directories on
  root-squashed NFS mounts.

\item Fixed a problem where the \Condor{starter} could crash if the
  job it was running used Condor's file transfer mechanism and the
  full path names to the job's files became longer than a few hundred
  characters.

\item The \Attr{image\_size} attribute of a job on Mac OS X is much
  closer to the values that \Prog{ps} returns.
  Previously it would be highly inflated.

\item Fixed a memory leak in the \Condor{gridmanager}.

\item Added the \Opt{-Storklog} argument to \Condor{submit\_dag} to make it
	compatible with the older perl script of the same name.

\item Removed support for the \Opt{-libc} option for \Condor{version}.

\item Added a fix to \Condor{compile} where if our internal \Prog{ld} managed
	to not be invoked during linking of a standard universe executable, 
	a warning is emitted.

\item Fixed a minor bug in the file transfer mechanism.  Specifically,
  if a VANILLA job had \Expr{when\_to\_transfer\_output} set to
  ON\_EXIT\_OR\_EVICT, wrote more than one output file, and was
  actually evicted, the condor \Condor{shadow} would have a fatal
  run-time error (shadow exception) and your job would be rerun.

\item DAGMan bug fixes:
\begin{itemize}
  \item If submit files for individual nodes referred to the same log
    file with different paths, \Condor{dagman} would read log events
    incorrectly and the DAG would fail.
    \Condor{dagman} is now able to recognize that the different paths
    actually refer to the same log file.

  \item Fixed a bug where DAGMan failed to monitor Stork job logs.

  \item If a node submit file doesn't specify a log file, the warning
	message now gets printed out in the the DAGMan log file.

  \item Fixed a bug that caused \Condor{dagman} to fail if first node
        submit file has continuation in log file line.


\end{itemize}

\item Bugs related to configuration
\begin{itemize}
  \item Fixed a bug where Condor daemons could crash if
    \Macro{COLLECTOR\_HOST} or \Macro{NEGOTIATOR\_HOST} was defined to
    be something bogus.

  \item Fixed potential crash in the \Condor{collector} when
    \Macro{COLLECTOR\_NAME} was too long.

  \item The default setting for \Macro{POOL\_HISTORY\_DIR} is no
    longer \Macro{SPOOL}.
    Using the spool directory would result in history files being
    obliterated by \Condor{preen}.

\end{itemize}

\item Fixed a bug which could result in a daemon crashing while it was
	writing to its logfile.

\item Fixed a signal handling bug in the checkpoint server which could
  cause the daemon to hang sometimes.

\item The Kerberos map file now tolerates spaces on either side of the
	equals sign instead of generating a parse error.

\item The \Opt{-analyze} option to \Condor{q} is only meaningful for certain
  universes.  \Condor{q} now warns if the output might not be meaningful. 

\item Java universe: when jar files are transferred to the execute
  machine (with \Expr{should\_transfer\_files} or
  \Expr{transfer\_input\_files}) the \Condor{starter} will use the
  local path (in the execute directory) for the jarfiles, instead of
  the original path specified in the submit file.

\item Previously, if a scheduler universe job died with a signal, the
  \Condor{schedd} would write multiple (conflicting) events into the
  UserLog file: a terminate event and an abort event.
  Now, only the terminate event is written, not the abort event.

\item Fixed a minor bug where if the \Condor{schedd} crashed or was
  killed at just the wrong moment while a job was being removed
  because the \Attr{periodic\_remove} expression had evaluated to
  TRUE, the job might have been successfully removed but the
  \Attr{RemoveReason} attribute could have been lost.
  Now, both actions are taken together atomically.
  If a job is successfully removed, it will always have a
  \Attr{RemoveReason} attribute.

\item Fixed a memory leak in the \Condor{collector}.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-6-5}Version 6.6.5}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item None.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item None.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug introduced in Condor version 6.6.2 that could cause
      \Condor{dagman} to segfault while parsing some DAG files, or
      fail to recognize already-completed nodes in a rescue DAG.

\item Fixed a bug in \Condor{dagman}, whereby it could fail to
      automatically discover a Condor job's userlog file if the job's
      submit file did not have whitespace surrounding the equal sign
      on the log file line.

\item Fixed a bug in \Condor{submit} that appears to only have
  effected OSX machines.
  Previously, submit files that only defined a single job and used
  \verb@queue@ without any numerical modifiers would result in an
  error like this: 
\footnotesize
\begin{verbatim}
     ERROR: "test.sub" doesn't contain any "queue" commands -- no jobs queued
\end{verbatim}
\normalsize
  Now, \Condor{submit} will properly process and submit the job from
  job description files that contain a single \verb@queue@ statement
  with no modifiers.

\item Fixed a bug in the AIX \Condor{starter} that was causing the
starter to sometimes kill itself when the job completed.  Because this
happened before the \Condor{starter} reported the job completion back
to the \Condor{shadow}, such a job would be restarted.

\item Fixed a few memory and registry handle leaks in the \Condor{schedd}
and \Condor{startd}. These leaks particularly affected Windows systems.

\item On Windows, Condor was known to have trouble accessing config files
with UNC paths (with appropriate permissions set). This has been fixed.

\item On Windows, \Condor{store\_cred} would fail if the account did not
have \verb@Log on Locally@ privileges, even if the account was allowed
to log in interactively. This has been fixed.

\item Fixed a bug on Windows that would cause the \Condor{schedd} to
crash if \Dflag{FULLDEBUG} was turned on, and the submitting user
account did not have Administrator access rights.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item \Condor{dagman} can fail to detect a job's progress if another
      job in the DAG specifies the same underlying userlog file using
      a different path or filename (e.g., log=foo and log=./foo) in
      its submit file.

\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-6-4}Version 6.6.4}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item This version only contains platform-specific bug fixes.
  Therefore, it was only released for the two effected platforms. 

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a major bug in the Windows NT/2000 port that caused the
  Condor daemons to crash when attempting to authenticate.

\item Fixed the bug in Condor's file transfer mechanism for Mac OSX
  that was introduced in version 6.6.3.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-6-3}Version 6.6.3}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item The Globus universe support for versions of Globus prior to 2.2 (specifically, those using GRAM 1.5 or earlier) has been removed.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item The Globus universe now supports submitting jobs to Globus Toolkit 3.2 installations.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item The negotiator no longer crashes when a grid site ClassAd sets WantAdRevaluate but does not contain an UpdateSequenceNumber.

\item Globus universe jobs were failing to go on hold when a \$\$() expression
could not be expanded.

\item On Windows, the system-wide TEMP variable is included in the
execute environment if it is not specified in the submit file.

\item Fixed a rarely-occurring bug when  the child process forked by the schedd gets stuck in an infinite loop when the user does ``condor\_submit -s''. This should also fix problems when the child process forked by the collector would sometimes get stuck in an infinite loop when \Expr{ COLLECTOR\_QUERY\_WORKERS > 0 } in the config file.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item The Condor file transfer mechanism is broken on Mac OSX in
  Condor version 6.6.3.
  OSX users should either upgrade to version 6.6.4, or install a
  patched \Condor{starter} binary available from
  \URL{http://www.cs.wisc.edu/condor/binaries/condor-6.6.3-patch1-MacOSX-PPC.tar.Z}. 

\end{itemize}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-6-2}Version 6.6.2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item There will be another release, 6.6.3, within a few weeks.  We decided to
	release this version now because it adds the AIX platform and has some bug
	fixes which we thought important enough for a release.  However, if you are
	not affected by the bugs fixed (see below) you may wish to wait for 6.6.3.
     

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Clipped support for AIX 5.2.
      This means VANILLA universe only - no checkpointing or STANDARD universe.

\item The setting \Macro{GRIDMANAGER\_GLOBUS\_COMMIT\_TIMEOUT} allows
   configuring the two phase commit timeout in Globus.  This maps to the
   two\_phase setting in the Globus RSL.

\item Added a new configuration variable,
      \Macro{DAGMAN\_MAX\_SUBMIT\_ATTEMPTS}, that controls how many
      times in a row \Condor{dagman} will attempt to execute
      \Condor{submit} for a given job before giving up.  It cannot be
      set to less than 1 attempt, or more than 10; if left undefined,
      it defaults to 6.

\item Added a new tool \Condor{updates\_stats} to dump out the update
statistics information from ClassAds in a human readable format.
Condor 6.6.1, by default, publishes ``update statistics'' into the
ClassAds as published by the \Condor{collector}.  This program parses
this output and displays it to the user in a readable format.

\item Changed the default \Condor{dagman} behavior so that it doesn't
      check for cycles at startup, only at runtime, since the former
      could be expensive for large DAGs.  Added a boolean
      \Attr{DAGMAN\_STARTUP\_CYCLE\_DETECT} config attribute to
      re-enable cycle-detection at startup.

\item \Condor{dagman} now offers a configuration variable,
      \Macro{DAGMAN\_MAX\_SUBMITS\_PER\_INTERVAL}, which controls how
      many individual jobs \Condor{dagman} will submit in a row before
      servicing other requests (such as a \Condor{rm}).

\item The grid\_monitor now automatically detects jobmanager scripts on the
      remote gatekeeper.  Previously it was limited to supporting the condor,
	  fork, lsf, pbs, and remote jobmanager scripts.

\item A new parameter, \Macro{SEC\_DEBUG\_PRINT\_KEYS}, controls whether or not
      the keys used for encryption get printed into the log.
	  The default is false.


\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Jobs that make use of Condor's file transfer mechanism were not
automatically authorized to read/write input/output files when
flocking to machines that did not happen to be in the
\Macro{HOSTALLOW\_WRITE} list.  This bug has existed since 6.3.

\item Eliminated a small chance that a grid\_monitor log file or state file
    might be reused.  The unique identifying numbers are now unique across
	the entire gridmanager, not each Globus resource.

\item Eliminated a race condition which might cause the grid monitor to
	erroneously decide that the status file was broken when in fact it
	was being uploaded and was empty.

\item The grid monitor now attempts to restart transfers in the event of
    globus-url-copy hanging.

\item Removed some settings from the default configuration files
  shipped with Condor that are no longer used in the code.

\item Fixed bugs in \Condor{dagman} parsing of submit files (to determine
  node log files).  Previously, a submit file line beginning with
  "log" (e.g., "LogLock = True") would be interpreted as a log file
  line.  Also, if "log" was defined twice in the submit file,
  \Condor{dagman} would incorrectly use the first definition, rather than
  the last.

\item Re-added PVM support for IRIX 6.5.

\item Fixed an indirect bug whereby \Condor{dagman} could fail with an
assertion error if it encounters both a terminate and a abort event in
the userlog for the same job; this can happen due to a bug in the
\Condor{schedd}, which is not yet fixed.

\item \Condor{dagman} now works right with nodes that have an initialdir
  specified in the node submit file.  (Previously, specifying
  an initialdir only worked if the log file path was absolute.)

\item \Condor{dagman} now responds more quickly to a request to be
      removed from the queue (via \Condor{rm}), even if it is in the
      midst of submitting jobs.  Previously, \Condor{dagman} would
      finish submitting all ready jobs before responding to a removal
      request, which could take a long time, and forced it to
      immediately remove all the jobs it had just submitted
      unnecessarily.

\item Fixed keyboard idle reporting on Mac OS X. Previously, the code
      would often return -1 on newer hardware. 

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item If a scheduler universe job terminates via a signal, the 
      \Condor{schedd} logs both a terminate event and an abort event
      to the userlog. 

\item Keyboard activity is not reported for pseudo-ttys on Mac OS X, only
      the physically connected keyboard

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-6-1}Version 6.6.1}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item \Condor{analyze} is not included in the downloads of Version 6.6.1.
  The existing binary from Version 6.6.0 is likely to work on all platforms
  for which it was released.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Added full support (including standard universe jobs with
  checkpointing and remote system calls) for Linux i386 RedHat 9
  (using gcc/g++ version 3.2.2 and glibc version 2.3.2). 

\item Added full support (including standard universe jobs with
  checkpointing and remote system calls) for Linux i386 RedHat 8
  (using gcc/g++ version 3.2 and glibc version 2.2.93). 

\item The time it takes \Condor{dagman} to submit jobs has been
      reduced slightly to improve up the startup time of large DAGs.

\item In order to help reduce load on the \Condor{schedd} when
      \Condor{dagman} is submitting jobs, there is a new config
      variable, \Macro{DAGMAN\_SUBMIT\_DELAY}, to specify the number
      of seconds \Condor{dagman} will sleep before submitting each
      job.

\item Enabled the ``update statistics'' in the \Condor{collector} by
      default in both the executable and in the default configuration.

\item Command-line arguments to \Condor{dagman} are now handled
      case-insensitively.

% commented out since i'm not sure we want to make a big deal of this
% new config file knob. -derek 1/12/04
% \item Added a new configuration macro
%     \Macro{MAX\_CLAIM\_ALIVES\_MISSED}, described on
%     page~\pageref{param:MaxClaimAlivesMissed}.
%     This setting controls how many keep alive messages a startd is
%     willing to miss before it releases the claim from a given schedd.

\item Added support for Condor-G and strong authentication to Condor
  for IRIX 6.5, but removed support for checkpointing and remote
  system calls.
  We plan to add support in Condor for IRIX's kernel-level
  checkpointing in a future release.

\item Added a \Opt{-p} option to \Condor{store\_cred} so that users
can now specify the the password on the command line instead of getting
prompted for it.

\item The gahp\_server helper process for Condor-G includes patches from
the LHC Computing Grid Project to increase data transfer performance of
the Condor-G client. Previous versions of Condor-G could bog down in
accepting new transfer requests, producing a variety of errors. 

\item Added a new configuration setting,
  \Macro{SUBMIT\_SEND\_RESCHEDULE} which controls whether or not
  \Condor{submit} should automatically send a \Condor{reschedule}
  command when it is done.
  Previously, \Condor{submit} would always send this reschedule so
  that the \Condor{schedd} knew to start trying to find matches for
  the new jobs.
  However, for submit machines that are managing a huge number of jobs
  (thousands or tens of thousands), this step would hurt performance
  in such a way that it became an obstacle to scalability.
  In this case, an administrator can set
  \MacroNI{SUBMIT\_SEND\_RESCHEDULE} to \verb@FALSE@, this extra
  step is not performed, and the \Condor{schedd} will try to find
  matches whenever the periodic timer in the \Condor{negotiator}
  (\MacroNI{NEGOTIATOR\_INTERVAL}) goes off.

\item Pool administrators can now specify the length of time before
  the \Condor{starter} sends its initial update to the
  \Condor{shadow} by defining
  \Macro{STARTER\_INITIAL\_UPDATE\_INTERVAL}. 
  The default is 8 seconds.
  This setting would not normally need changing except to fine-tune a
  heavily loaded system.

\item Administrators can now specify the default session duration for
  each Condor subsystem.
  This allows for fine tuning the image size of running Condor daemons
  if the memory footprint is a concern.
  The default for tools is 1 minute, the default for \Condor{submit}
  is one hour, and the default for daemons is 100 days.
  This does not mean that tools cannot run more than one minute or
  submit cannot run for more than an hour; it only affects memory
  usage.

\item Added new configuration setting
  \Macro{GRID\_MONITOR\_HEARTBEAT\_TIMEOUT}.
  If this many
  seconds pass without hearing from the grid\_monitor, it is
  assumed to be dead.  Defaults to 300 (5 minutes).  Increasing
  this number will improve the ability of the grid\_monitor to
  survive in the face of transient problems but will also
  increase the time before Condor notices a problem.  Prior to
  this change the gridmanager always waited 5 minutes, the user
  could not change the setting.

\item Added new configuration setting
  \Macro{GRID\_MONITOR\_RETRY\_DURATION}.  
  If something goes wrong
  with the grid\_monitor at a particular site (like
  \MacroNI{GRID\_MONITOR\_HEARTBEAT\_TIMEOUT} expiring), it will be retried
  for this many seconds.  Defaults to 900 (15 minutes).  If we
  can't successfully get it going again the grid monitor will be
  disabled for that site until 60 minutes have passed.  Prior to
  this change the condor\_gridmanager wait 60 minutes after any
  failure.

\end{itemize}



\noindent Bugs Fixed:

\begin{itemize}

\item Fixed bugs related to network communication and timeouts that
  impact scalability in Condor:
  \begin{itemize}
    \item Fixed a bug inside Condor's network communication layer that 
      could result in Condor daemons blocking trying to read more data
      after a socket had already been closed.
    \item Fixed a \Condor{negotiator} bug that could, in certain rare
      circumstances, cause a \Condor{schedd} to hang for five minutes
      while trying to communicate with it.
    \item Fixed a bug in which TCP connections would re-authenticate
      needlessly when Condor's strong authentication was enabled.
      This was not harmful but incurred a bit of overhead, especially
      when using Kerberos authentication.
  \end{itemize}

\item Fixed bugs related to network security sessions which were
  getting cleared out.
  If the timing was unfortunate, this could cause some jobs to fail
  immediately after completion.
  So, Condor no longer clears out security sessions periodically (it
  used to happen every 8 hours) nor does it do so when a daemon
  receives a \Condor{reconfig} command.

\item Fixed a bug in the standard universe where C++ code that threw an 
exception would result in abortion of the executable instead of the
delivery of the exception. This bug affects Condor version 6.6.0 for
Redhat 7.x.

\item Fixed a \Condor{shadow} bug that could result in a fatal error
  if the following 3 conditions were met: (1) the job enables Condor's
  file transfer mechanism, (2) the job wants Condor to automatically
  figure out what files to transfer back (the default), and (3) the
  job does not specify a userlog.

\item Fixed bug whereby \Condor{dagman}, if removed from the queue via
      \Condor{rm}, could fail to remove all of its submitted jobs if
      any of their submit events had not yet appeared in the userlog.

\item Fixed a few bugs in \Condor{preen}:
  \begin{itemize}
  \item It will no longer potentially remove files related to a valid
    Computing on Demand (COD) claim on an otherwise idle machine.
  \item \Condor{preen} will no longer keep reporting that it had
    successfully removed a directory which was in fact failing to be
    removed.
  \end{itemize}

\item Fixed the faulty argument parsing in \Condor{rm},
  \Condor{release}, and \Condor{hold}.
  Before you could accidentally type \verb@condor_rm -analyze@, and it
  would remove all of your jobs.
  Now it gives an error.

\item On Windows, when you type a command like
  \verb@condor_reconfig.exe@ instead of \verb@condor_reconfig@, you no
  longer get an error.

\item Fixed a bug on Windows that would cause ``GetCursorPos() failed''
  to appear repeatedly in the StartLog. The startd now uses a different
  function to track mouse activity that does not have a tendency to fail.

\item Fixed a bug on Windows that would prevent some \Condor{shadow}
  daemons from obtaining a lock to their log file under heavy load, and
  thus causing them to EXCEPT().

\item Fixed a bug on Windows where file transfers would incorrectly fail
because of bad permissions when using domain accounts with nested groups,
or when UNC paths were used.

\item Fixed the bug where the \Condor{starter} would fail to transfer
  back core files created by Vanilla, Java and MPI universe jobs.
  This bug was introduced in Condor version 6.5.2.
  Now, Condor correctly transfers back any core files created by
  faulty user jobs in any job universe.

\item In some circumstances, \Condor{history} would fail to read
  information about some jobs, and would report errors. In particular,
  when jobs had large environments, it would fail. This has been
  corrected.

\item Fixed a rare bug affecting \Condor{dagman} when job-throttling
      was enabled: if \Condor{dagman} was removed from the queue
      together with some of its own jobs (e.g., via \verb@condor_rm -a@),
      it would quickly submit new jobs to replace them before
      recognizing that it needs to exit.  It now shuts down
      immediately without submitting and then removing these
      unnecessary jobs.

\item Fixed a potential security problem that was introduced in Condor
  version 6.5.5 when the \Macro{REQUIRE\_LOCAL\_CONFIG\_FILE}
  configuration setting was added.
  This setting used to default to FALSE if it was not defined in the
  configuration files.
  It now defaults to TRUE.
  If administrators define local configuration files for the machines
  in their pool, it should be a fatal error if those files don't exist
  unless the administrators actively disable this check by defining 
  \MacroNI{REQUIRE\_LOCAL\_CONFIG\_FILE} to be FALSE.

\item Fixed a bug on Windows that would cause the \Condor{startd} to
EXCEPT() if the \Condor{starter} exited and left orphaned processes to
be cleaned up. This bug first appeared in 6.5.0.

\item Fixed a bug on Windows that would cause graceful shutdowns on
Windows (such as when \verb@condor_vacate@  is called) to fail to
complete.

\item The gahp\_server helper program, which provides Globus services
to Condor-G, was always dynamically linked, even in statically-linked
releases.
The statically linked distributions of Condor now include a static
gahp\_server.

\item Fixed minor bug in parsing XML user log files that contain empty
  strings. 

\item Fixed the messages written to the Condor daemon log files in
  various error conditions to be more informative and clear:
  \begin{itemize}
  \item The error message in the SchedLog that indicates that swap
    space has been depleted has been rephrased so it appears to be
    significant.
  \item Certain serious error messages are now being written to the 
    \Dflag{ALWAYS} debug level that used to only appear if other debug
    levels were enabled.
  \item Clarified log messages related to errors looking up user
    information in the passwd database on UNIX and for creating
    dynamic users on Windows.
  \item Log messages related to keep-alives sent between the
    \Condor{schedd} and \Condor{startd} (written to \Dflag{PROTOCOL})
    now include the \Attr{ClaimId} on both sides, so that it is easier
    to find potential problems and figure out which keep-alive
    messages correspond to what resources.
  \item Added more useful information to certain errors relating to 
    security sessions and strong authentication.
  \item Fixed the formatting of some messages to correctly include a
    newline at the end of the message.
  \end{itemize}

\item Fixed a bug in the \Condor{configure} installation tool.
  Previously, it would set \MacroNI{MAIL\_PATH}, which doesn't exist
  in Condor and had no effect.
  Now, \Condor{configure} correctly sets \Macro{MAIL}, instead.

\item Fixed bug in userlog code in the CondorAPI library to prevent
  segmentation faults.

\item Clarified log messages for Condor-G's GridmanagerLog,
  especially those relating to the grid monitor.

\item Fixed potential race condition when using the grid monitor.  
  Condor-G now identifies partial grid monitor status updates and 
  waits for the update to complete.


\item The grid\_monitor is slightly more robust in the face of
  unexpected behavior by the Globus jobmanager.  This is only a
  partial fix, for complete success you really need the Globus
  patch at
  \URL{http://bugzilla.globus.org/bugzilla/show\_bug.cgi?id=1425}

\item Internal timeouts in the grid\_monitor have been increased,
  increasing robustness during transient errors.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item Submission of MPI jobs from a Unix machine to run on Windows
machines (or vice versa) fails for machine\_count > 1.  This is
not a new bug.  Cross-platform submission of MPI jobs between
Unix and Windows has always had this problem.

\item A multiple install of Condor's standard universe support libraries
onto an NFS server for the purposes of having a heterogeneous mix of Linux
distribution revisions all being able to utilize the same \Condor{compile}
does not function correctly if Redhat 9 is one of the distributions.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-6-0}Version 6.6.0}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent New Features:

\begin{itemize}

\item The \Condor{dagman} debugging log now reports the total number
      of ``Un-Ready'' Nodes (i.e. those waiting for unfinished
      dependencies) in its periodic summaries.  In the past, the
      omission of this state led to confusion because the total of all
      reported job states didn't always match the total number of jobs
      in the DAG.

\item Most Condor commands (\Condor{on}, \Condor{off},
  \Condor{restart}, \Condor{reconfig}, \Condor{vacate},
  \Condor{checkpoint}, \Condor{reschedule}) now support a \Opt{-all}
  command-line option to specify which daemons to act on.
  This is more efficient and much easier to use than previous methods
  for accomplishing the same effect.
  Using \Opt{-all} with \Condor{off} correctly leaves the existing
  \Condor{master} processes running on each host, so that a subsequent
  \Condor{on} would work.
  See section~\ref{sec:Pool-Shutdown-and-Restart} on
  page~\pageref{sec:Pool-Shutdown-and-Restart} for more details on
  proper use of \Opt{-all} with \Condor{off} and \Condor{on}

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug under Solaris 8 with Update 6+, and Solaris 9 where
Condor would incorrectly report the console and mouse idle times as zero.

\item The standard-universe fetch\_files feature was not cleaning up
temporary files on the execution machine.

\item In rare circumstances, a Linux kernel bug results in conflicting
information about system boot time (\File{/proc/stat} and
\File{/proc/uptime}). 
Specifically, the "btime" field in \File{/proc/stat} suddenly jumps to
the present moment and then stays at that value.  This
was resulting in incorrect estimation of process ages, which caused
Condor's estimation of CondorLoadAvg to be completely wrong.  A more
robust heuristic is now being used.

\item A long configuration line with with continuation lines can cause the
config file parser to not properly skip the leading whitespace from
the continued lines.  This has been corrected.

\item The Grid Monitor now will automatically probe for and work with
``unknown'' batch systems.

\item Fixed a bug where under certain circumstances \Condor{dagman}
      would fail to detect an unsuccessful invocation of
      \Condor{submit}, and would instead report the job as
      successfully submitted with job id 0.0.

\item Fixed a bug which was causing problems when a periodic\_remove
expression for a scheduler universe job evaluates to true.  Under
these conditions, the schedd did not log the job termination to the
job log.  Additionally, the schedd would exit with an error status.

\item Fixed a recently-introduced \Condor{dagman} bug where the number
      of node retries (specified with the RETRY keyword) wasn't being
      updated after some failures; instead, the node would be allowed
      to retry indefinitely if it kept failing.

\item Fixed a recently-introduced bug where shutting down the
      \Condor{schedd} caused \Condor{dagman} to remove all its jobs
      from the queue and write a rescue file, rather than simply
      exiting so that it could recover automatically upon restart.

\item Changed the default ``Periodic Expression Interval'' parameter
(PERIODIC\_EXPR\_INTERVAL) from 60 seconds to 300 seconds.

\item Whenever \Condor{reconfig} was used to re-configure multiple
  daemons which included the \Condor{collector} for a pool, the
  command would start to fail after the \Condor{collector} was
  reconfigured due to problems with security sessions in Condor's
  strong authentication code.
  This situation no longer causes problems for the \Condor{reconfig}
  tool, and it can properly re-configure multiple daemons at once,
  even if one of them is the \Condor{collector} for a pool.

\item Most Condor commands (\Condor{on}, \Condor{off},
  \Condor{restart}, \Condor{reconfig}, \Condor{vacate},
  \Condor{checkpoint}, \Condor{reschedule}) now check to make sure
  they are not sending a duplicate command if the user specifies the
  same target machine or daemon twice.  For example:
\begin{verbatim}
     condor_reconfig hostname1 hostname2 hostname1
\end{verbatim}
  will only send a single reconfig command to \verb@hostname1@.

\item Fixed a bug in the HPUX version of Condor which was causing the
startd to occasionally abort operation.  This has been in Condor since
version 6.1.1.

\item The Condor daemons will no longer overwhelm NIS servers
when large numbers of daemons are running. Condor now caches
uid and group information internally, and refreshes the
cache entries on a specified interval (which defaults to 5
minutes). See section~\ref{param:PasswdCacheRefresh} on
page~\pageref{param:PasswdCacheRefresh} for more details.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item The \Condor{preen} program does not know about Computing on
  Demand (COD) claims.
  If there are no regular Condor jobs on a given machine, but there
  are COD claims, and \Condor{preen} is spawned, it will remove files
  related to the COD claims.
  In version 6.6.0, sites using COD are encouraged to disable
  \Condor{preen} by commenting out the \MacroNI{PREEN} setting in the
  config files.
  This bug has been fixed in Condor version 6.6.1.

\item Normally, if a user's job crashes and creates a core file on a
  remote execution machine, the \Condor{starter} will automatically
  transfer the core file back to the submit machine.
  However, beginning in Condor version 6.5.2, if a vanilla, Java, or
  MPI universe job creates a core file, the \Condor{starter} will fail
  to transfer it back.
  This bug will be fixed in version 6.6.1.
  
\item There are a few bugs related to Condor tools failing to
  correctly locate the \Condor{negotiator} daemon.
  These bugs usually show up if a site is using non-standard ports for
  the central manager daemon.
  However, some of the bugs show up regardless of if the negotiator is
  listening on the standard port or not. 

  \begin{itemize}
    \item \verb@condor_config_val -negotiator@ queries the
          \Condor{collector}, instead of querying the
          \Condor{negotiator} like it should.  

    \item Using the \Opt{-pool} option to \verb@condor_q -analyze@
          will not work.
          The tool will fail to find and query the \Condor{negotiator}
          for user priorities which it needs to determine why jobs may
          not be running.

    \item The Condor tools that support either the \Opt{-negotiator}
          or \Opt{-collector} options do not work when a user also
          specifies the \Opt{-pool} to define a remote pool to
          communicate with.
          The tools print a somewhat confusing message in this case.

    \item Most Condor tools that support \verb@-pool hostname@ will
          also recognize \verb@-pool hostname:port@ if the remote
          \Condor{collector} is listening on a non-standard port.
          However, the \Condor{findhost} tool does not work if given a
          \Opt{-pool} option that includes a port.

  \end{itemize}

\end{itemize}

\begin{center}
\begin{table}[hbt]
\begin{tabular}{|ll|} \hline
\emph{Architecture} & \emph{Operating System} \\ \hline \hline
Hewlett Packard PA-RISC (both PA7000 and PA8000 series) & HPUX 10.20 \\ \hline
Sun SPARC Sun4m,Sun4c, Sun UltraSPARC & Solaris 2.6, 2.7, 8, 9 \\ \hline
Silicon Graphics MIPS (R5000, R8000, R10000) & IRIX 6.5 \\ \hline
Intel x86 & Red Hat Linux 7.1, 7.2, 7.3 \\
 & Red Hat Linux 8 (clipped) \\ \hline
 & Red Hat Linux 9 (clipped) \\ \hline
 & Windows NT 4.0 Workstation and Server (clipped) \\ \hline
 & Windows 2000 Professional and Server, 2003 Server (clipped) \\ \hline
 & Windows XP Professional (clipped) \\ \hline
ALPHA & Digital Unix 4.0 \\
 & Red Hat Linux 7.1, 7.2, 7.3 (clipped) \\ \hline
 & Tru64 5.1 (clipped) \\ \hline
PowerPC & Macintosh OS X (clipped) \\
Itanium & Red Hat Linux 7.1, 7.2, 7.3 (clipped) \\
\end{tabular}
\caption{\label{6.6.0-supported-platforms}Condor version 6.6.0 supported platforms}
\end{table}
\end{center}

