%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\label{sec:History-7-0}Stable Release Series 7.0}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This is a stable release series of Condor.
It is based on the 6.9 development series.
All new features added or bugs fixed in the 6.9 series are available
in the 7.0 series.
As usual, only bug fixes (and potentially, ports to new platforms)
will be provided in future 7.0.x releases.
New features will be added in the 7.1.x development series.

On backwards compatibility:
we believe that Condor 7.0.x and 6.8.x are wire-compatible, 
and can be freely mixed between computers in a Condor pool. 
However, we do not regularly test this compatibility and cannot guarantee it, 
so we recommend using a single release of Condor when possible. 
Please note that although you can mix Condor 7.0.x and 6.8.x in a pool, 
you cannot mix them on a single computer. 
That is, a \Condor{master} daemon running 6.8.x cannot run Condor daemons 
from version 7.0.x, or vice-versa.

The details of each version are described below.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-0-6}Version 7.0.6}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item None.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item None.

\end{itemize}

\noindent Configuration Variable Additions and Changes:

\begin{itemize}

\item None.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item In some rare cases, the \Condor{startd} failed to fully preempt jobs.
The job itself was killed, but the \Condor{starter} process watching over
it would not be killed.  The slot would then stay in the Preempting state
indefinitely.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-0-5}Version 7.0.5}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

This release contains many bug fixes and some improvements to error handling
of Local Universe jobs. Note that some of the bug fixes are
security-related; therefore, we recommend sites either upgrade Condor, or
restrict permissions on who is allowed to submit Condor jobs to trusted
users. Bug fixes that are security related are clearly marked in the Bugs
Fixed section below along with a description of the potential security
impact. The Condor Project believes in the full disclosure of information,
and therefore complete vulnerability details can be found at
\URL{http://www.cs.wisc.edu/condor/security/}. However, in order to give an
adequate upgrade window for production installations, we will delay posting
the full vulnerability details fixed in this release for 30 days (until the
week of November 3rd 2008). 


\noindent New Features:

\begin{itemize}

\item Local universe jobs now go on hold for the same specific reasons that
vanilla jobs may go on hold.  Examples are missing input or executable files.
Previously, when local universe jobs failed in this manner,
the jobs returned to the idle state in the job queue,
repetitively attempting to run, 
and failing over and over until the job is removed.

\item Local universe jobs now have the ClassAd attribute \Attr{NumShadowStarts}.
Although local universe jobs do not have a \Condor{shadow} process, 
this attribute
is introduced to keep management of local universe as similar to
vanilla universe as possible.  For local universe jobs, this attribute
is identical to the attribute \Attr{JobRunCount}, 
which indicates how many times a
local \Condor{starter} process has been created to run the job.

\end{itemize}

\noindent Configuration Variable Additions and Changes:

\begin{itemize}

\item None.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item \Security A flaw was found and fixed in the way Condor processes user submitted
jobs. It was possible for a user who had permissions to submit jobs into
Condor to do so in a way that could cause that job to run as any other
non-root user. We have not had any reported incidents exploiting this
flaw. (CVE-2008-3826)

\item \Security A stack-based buffer overflow flaw was found and fixed in the
\Condor{schedd} daemon. A user who had permissions to submit a job could
do so in a manner that could cause the \Condor{schedd} to crash, or
potentially, execute arbitrary code on the submit machine with the
\Condor{schedd}'s identity. We are not aware of any known exploits for
this flaw. We have not had any reported incidents exploiting this flaw.
(CVE-2008-3828)

\item \Security A denial-of-service flaw was found and fixed in the \Condor{schedd}
daemon. A user who had permissions to submit a job could have done so in a
manner that would cause \Condor{schedd} to crash. 
We have not had any reported incidents exploiting this flaw. (CVE-2008-3829)

\item \Security A flaw was found and fixed in the way Condor processes allow and deny 
net masks for access control. 
If Condor's configuration file contained overlapping net masks in 
the allow or deny rules, it could have caused those rules to be ignored, 
potentially allowing unintended access to users in Condor's 
deny authorization lists. 
We have not had any reported incidents exploiting this flaw. (CVE-2008-3830) 

% Fixed by Red Hat
\item Fixed a segmentation fault bug with \Condor{submit} \Opt{-dump} when
\Expr{universe=grid} or \Expr{x509userproxy=<anything>}.

\item Fixed a stack overflow bug in the \Condor{negotiator} daemon.

\item Fixed \Condor{submit} \Opt{-dump} such that it would function with the
standard universe.

\item Fixed a memory leak in the \Condor{startd}, which occurred during the
handling of a \Condor{reconfig} command.

\item When the configuration variable \Macro{NEGOTIATOR\_CONSIDER\_PREEMPTION}
is defined to be \Expr{False},
this no longer results in machines in the Owner state being ignored
during matchmaking.  Previously, even if \MacroNI{START} was \Expr{True},
machines in the Owner state were disregarded.

\item Setting \Attr{JobLeaseDuration} to be less than 15 minutes caused the
\Condor{schedd} daemon to abort and restart the next time a
\Condor{reconfig} command was executed.
The error message in the \Condor{schedd} log appeared as:

\footnotesize
\begin{verbatim}
ALIVE_INTERVAL in the condor configuration is too high (300).
\end{verbatim}
\normalsize

\item Fixed a slow memory leak affecting the \Condor{startd},
\Condor{schedd}, and \Condor{collector} daemons.  This leak would probably
require many months of continuous operation before causing noticeable problems.

\item Fixed a bug that caused a \Condor{schedd} daemon crash.
The crash occurred during a fast shut down of the
\Condor{schedd} daemon as it dealt with local universe
jobs or with any job that required reconnection when
the \Condor{schedd} daemon started up.

\item Local and scheduler universe jobs were failing to increment the
\Attr{JobRunCount} attribute in the job ClassAd when an attempt to run
the job was made.  This problem was introduced in 6.9.5.

\item Some rare types of failures during file transfer caused the
Condor daemon conducting the transfer to hang indefinitely.  For
example, if the file transfer process created by the \Condor{schedd}
was killed by an administrator or crashed due to an internal error,
the \Condor{schedd} would become unresponsive.

\item GCB was updated, fixing minor bugs with GCB temporary files 
(typically the file(s) \File{/tmp/gcb-inherit-*}).
These bugs did not impact GCB functionality.  Earlier
versions would leave temporary files behind. Temporary files would have
permissions of 000.  With the fix, under normal operations the files should be
deleted, and the \Login{condor} user should have read and write access to the files.

\item Evaluation of the configuration variable \Macro{STARTD\_AD\_REEVAL\_EXPR}
did not work for many types of expressions.
The problem resulted in the following message in the 
\Condor{negotiator} daemon log:

\begin{verbatim}
Can't evaluate STARTD_AD_REEVAL_EXPR  ...
\end{verbatim}

\item Reconnecting to parallel universe jobs after a restart of the
\Condor{schedd} daemon, would sometimes fail.  The failure was caused
by the \Condor{shadow} trying to connect to the address of the
previous instance of the \Condor{schedd} rather than the address of
the current instance.

\item Made the \Condor{gridmanager} less aggressive in forwarding refreshed
proxies for gt2 grid universe jobs. Now, the refreshed proxy will not be
forwarded until the old proxy has less than six hours of life until
expiration.

\item Fixed a bug in the \Condor{gridmanager} that could result in job
status updates from the Grid Monitor to be ignored.

\item The Grid Monitor no longer changes the last-modified time of GRAM
state files whose job's status is FAILED. This should make it easier for
file cleaners to remove the the GRAM state files of old, abandoned jobs.

\item Fixed a problem that could cause flocked jobs to fail due to
authorization errors in the \Condor{starter}. Such failures were more
likely to occur for long-running jobs or if the \Condor{schedd} were
issued a full reconfig during the job's execution.

\item Fixed a \Condor{gridmanager} crash on Windows. This crash only
appeared if \Macro{GRIDMANAGER\_DEBUG} were set to a higher level than
the default.

\item In PrivSep mode, a job would previously fail if it created a
symlink in its sandbox pointing to a file owned by a UID other than
that used to run the job. This behavior has been fixed.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item Descriptions of previously undocumented Condor Perl module subroutines
  have been added to the manual.  See section~\ref{sec:condor-pm}.

\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-0-4}Version 7.0.4}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item This release fixes a problem causing possible incorrect handling
of wild cards in authorization lists.
Examples of the configuration variables that specify
authorization lists are
\begin{verbatim}
  ALLOW_WRITE
  DENY_WRITE
  HOSTALLOW_WRITE
  HOSTDENY_WRITE
\end{verbatim}
If a configuration variable uses the asterisk character
(\verb@*@) in configuration variables that specify the
authorization policy, it is advisable to upgrade.
This is especially true for the 
use of wild cards in any \MacroNI{DENY} list,
since this problem could result in
access being allowed, when it should have been denied.
This issue affects all previous versions of Condor.

\item The default daemon-to-daemon security session duration has been
changed from 100 days to 1 day. This should reduce memory usage in the
\Condor{collector} in pools with short-lived \Condor{startd}s (e.g. 
glidein pools or pools whose machines are rebooted every night).

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Added functionality to periodically update timestamps on lock files. 
This prevents administrative programs from deleting in-use lock files and
causing undefined behavior.

\item When the configuration variable \Macro{SCHEDD\_NAME} ends in 
the \verb$@$ symbol,
Condor will no longer append the fully qualified
host name to the value.
This makes it possible to configure a high availability
job queue that works with the remote submission of jobs.

\end{itemize}

\noindent Configuration Variable Additions and Changes:

\begin{itemize}

\item Added configuration variable: \Macro{LOCK\_FILE\_UPDATE\_INTERVAL}.
Please see page~\pageref{param:LockFileUpdateInterval} for a complete
description.

\item Changed the default value of configuration variable
\Macro{SEC\_DEFAULT\_SESSION\_DURATION} from 8640000 seconds (100 days)
to 86400 seconds (1 day).

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug in the \Condor{c-gahp} that caused it to fail repeatedly
on Windows, if more than two Condor-C jobs were submitted at the same time.

\item Fixed a problem that caused the \Condor{collector}'s memory usage
to increase dramatically, if \Condor{findhost} was run repeatedly.

\item Fixed a bug where Windows jobs suspended by Condor would never
be continued, despite log files indicating successful continuation.
This problem has existed since the 6.9.2 release of Condor.

%PR 937
\item Fixed a problem that could cause \Condor{dagman} to core dump
if straced, especially if the \File{dagman.out} file is on a shared
file system.

\item Fixed a problem introduced in 7.0.1 that could cause the \Condor{schedd}
daemon to crash when starting parallel or MPI universe jobs.  In some cases,
the problem would result in the following log message:

\footnotesize
\begin{verbatim}
ERROR ``Assertion ERROR on (mrec->request_claim_sock == sock)'' \
  at line 1361 in file dedicated_scheduler.C
\end{verbatim}
\normalsize

\item The \Condor{procd} daemon now periodically updates the timestamps on
the named pipe file system objects that it uses for communication.
This prevents these objects from being cleaned up by programs like
\Prog{tmpwatch}, which would result in Condor daemon exceptions.

\item Fixed a problem introduced in Condor 7.0.2 that would cause daemons
to fail on start up on Windows 2000.

\item Fixed a problem where standard universe jobs would fail to start
when using PrivSep, if the \Macro{PROCD\_ADDRESS} configuration variable was not
defined.

\item If the X509 proxy of a vanilla universe job has been refreshed, the
updated file will no longer be returned when the job completes.

\item If ClassAd attributes \Attr{StreamOut} or \Attr{StreamErr} are
missing from the job ClassAd of a grid universe job,
the default value for these attributes is now \Expr{False}.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item A bug in 7.0.4 affects jobs using Condor file transfer on submit
machines that are configured to deny write access from execute
machines.  The result is that output from jobs may fail to be copied
back to the submit machine.  The problem may or may not affect jobs
that run for less than eight hours, but it definitely will affect jobs
that run for more than eight hours.  An example of a configuration
vulnerable to this problem is one where DAEMON level access is allowed
to all execute nodes but WRITE level access is not.  When the problem
happens, the \Condor{shadow} log will contain a line like the following:

\begin{verbatim}
DaemonCore: PERMISSION DENIED to unknown user from host ...
for command 61001 (FILETRANS_DOWNLOAD), access level WRITE
\end{verbatim}

The workaround for this problem is to allow WRITE access from the
execute nodes.  If the existing configuration requires WRITE access to
be authenticated, then simply add WRITE access by the authenticated
condor identities associated with all execute nodes.  If WRITE access
is not currently required to be authenticated, then allow
unauthenticated WRITE access from all worker nodes.  Note that this
does \emph{not} imply that execute nodes will be able to modify the
job queue without authenticating.  Remote commands that modify the job
queue (for example, \Condor{submit} or \Condor{qedit}) always require that the
user be authenticated, no matter what configuration options are used;
if no method of remote authentication can succeed in the pool for
WRITE operations, then commands that modify the job queue can only run
on the submit machine.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-0-3}Version 7.0.3}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item This is a bug fix release.  A bug in Condor version 7.0.2 sometimes caused
the \Condor{schedd} to become unresponsive for 20 seconds when starting
the \Condor{shadow} to run a job.
Therefore, anyone running 7.0.2 is strongly encouraged to upgrade.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item None.

\end{itemize}

\noindent Configuration Variable Additions and Changes:

\begin{itemize}

\item The configuration variable \Macro{VALID\_SPOOL\_FILES} now automatically 
includes \File{SCHEDD.lock},
the lock file used for high availability \Condor{schedd} fail over.  Other
high availability lock files are not currently included.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a problem sometimes causing minutes or more of lag between
the time of job suspension or unsuspension and the corresponding entries
in the job user log.

\item Fixed a problem in \Condor{q} \Opt{-better-analyze} handling
requirements expressions containing  the expression \Expr{=!= UNDEFINED}.

\item Configuration variable \Macro{GRIDMANAGER\_GAHP\_CALL\_TIMEOUT}
is now recognized for nordugrid grid universe jobs.

\item Fixed a bug that could cause the \Condor{schedd} daemon to abort
and restart some time after a graceful restart,
when jobs to which the \Condor{schedd} daemon reconnected were preempted.

\item Fixed a bug causing failure to reconnect to jobs which use
\Expr{\$\$([\textit{expression}])}
in their ClassAds.  The jobs would go on
hold with the hold reason:
\AdStr{Cannot expand \$\$([\textit{expression}]).}

\item Fixed a bug in Condor version 7.0.2 that sometimes caused 
the \Condor{schedd} daemon to become
unresponsive for 20 seconds when starting the \Condor{shadow} daemon
to run a job.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item See 
  section~\ref{sec:WebService-Implementation}
  for documentation on finding the port number the \Condor{schedd} daemon
  is listening on for use with the web service API.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-0-2}Version 7.0.2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item On Unix, Condor no longer requires its \Macro{EXECUTE} directory to
be world-writable, as long as it is not on a root-squashed NFS mount and is
owned by the user given in the \Macro{CONDOR\_IDS} setting (or by Condor's
real UID, if not started as \Login{root}). Condor will automatically remove
world-writability from existing \MacroNI{EXECUTE} directories where possible.
Note: The \MacroNI{EXECUTE} directory has never been required to be
world-writable on Windows.

\item With this release, a binary package for IA64 SUSE Linux Enterprise 8
will no longer be made available.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item A clipped port to FreeBSD 7.0 x86 and x86\_64 is available, but at this
time, it is not available for download as a binary package.

\item Previously, \Condor{q} \Opt{-better-analyze} was supported on most
but not all versions of Linux.  It is now supported on all Unix platforms,
but not yet on Windows platforms.

\end{itemize}

\noindent Configuration Variable Additions and Changes:

\begin{itemize}

\item The new configuration variable
\Macro{GRIDMANAGER\_MAX\_WS\_DESTROYS\_PER\_RESOURCE} limits the number
of simultaneous WS destroy commands issued to a given server for grid
universe jobs of type gt4. The default value is 5.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug in the standard universe where if a Linux machine was
  configured to use the Network Service Cache Daemon (nscd), taking
  a checkpoint would be deferred indefinitely.

\item Fixed a bug that caused the Quill daemon to crash.

\item Fixed bug that prevented Quill, when running on a
  Windows host, from successfully updating the database.

\item Fixed a bug that prevented Quill's \Condor{dbmsd} daemon from proper
  shutting down upon request when running on Windows platforms.

% condor-admin 17847
\item Fixed a bug that caused Stork to be completely broken.

\item As a back port from Condor versions 7.1,
  the Windows Installer is now completely
  internationalized: it will no longer fail to install because of a
  missing "Users" group; instead, it will use the regionally appropriate
  group.

\item As a back port from Condor versions 7.1,
  interoperability with Samba (as a PDC) has been improved.
  Condor uses a fast form of login during credential validation.
  Unfortunately, this login procedure fails under Samba,
  even if the credentials are valid.  The new behavior is to attempt
  the fast login, and on failure, fall back to the slower form.

\item As a back port from Condor versions 7.1,
  Windows slot users no longer have the
  Batch Privilege added, nor does Condor first attempt a Batch login
  for slot users.  This was causing permission problems on hardened
  versions of Windows, such as Windows Sever 2003, in that not
  interactive users lacked the permission to run batch files 
  (via the \Prog{cmd.exe} tool). 
  This affected any user submitting jobs that used
  batch files as the executable.

\item Fixed a bug that could sometimes cause the \Condor{schedd}
  to either EXCEPT or crash shortly after a user issues a \Condor{rm}
  command with the \Opt{-forcex} option.

\item \Condor{history} in a Quill environment,
  when given the \Opt{-constraint} option,
  would ignore attributes from the vertical schema.  This has been fixed.

\item In Unix, when started as \Login{root},
  the \Condor{master} now changes the
  effective user id back to \Login{root} (instead of condor)
  when restarting itself.
  This occurs for example due to the command \Condor{restart}.
  This makes no difference unless the \Condor{master} is wrapped
  with a script, and the script expects to be run as \Login{root}
  not only on initial start up, but on restart as well.

\item The dedicated scheduler would sometimes take two negotiation cycles
  to acquire all the machines it needed to run a job.
  This has been now fixed.

% PR 938
\item \Condor{dagman} no longer prints "Argument added" and
  "Retry Abort Value" diagnostic messages at the default verbosity,
  to reduce the size of the \File{dagman.out} file and the start up time
  for very large DAGs.

\item \Condor{dagman} now prints a few fatal parse errors at lower
  verbosity settings than it did previously.

\item \Condor{preen} no longer deletes \Prog{MyProxy} password files in the
  Condor spool directory.

\item When using TCP updates (UDP updates are the default), the
  \Condor{collector} would sometimes freeze for 20 seconds when
  receiving an invalidation notice.  
  The notice is received when Condor is being turned off
  on a machine in the pool.

\item Fixed a case in which the \Condor{schedd}'s job queue log file
could get corrupted when encountering errors writing to the disk such
as `out of space'.  This type of corruption was detected by the
\Condor{schedd} the next time it restarted and read the file to
restore the job queue, so you would only have been affected by this
problem if your \Condor{schedd} refused to start up until you fixed or
removed the job queue log file.  This bug has existed in all versions
of Condor, but it became more likely to occur in 6.9.4.

\item The configuration setting \MacroNI{JAVA} may now contain spaces.
Previously, this did not work.

\item Fixed a problem that caused occasional failure to detect hung
Condor daemons.

\item Fixed a file descriptor leak in the negotiator.  The leak happened
  whenever the negotiator failed to initiate the NEGOTIATE command to
  a \Condor{schedd}, for example if security negotiation failed
  with the \Condor{schedd}.
  Under Unix, this would eventually cause the \Condor{negotiator} to run out of
  file descriptors, exit, and restart.  This bug affected all previous
  versions of Condor.

\item Fixed several bugs in the user log reader that caused it to
  generate an invalid persisted state if no events had been read in.
  When read back in, this persisted state would cause the reader to
  segfault during initialization.

\item Fixed a bug causing communication problems if different portions
of a Condor pool were configured with different values of
\MacroNI{SEC\_DEFAULT\_SESSION\_DURATION}.  This bug affects all
previous versions of Condor.  The client side of the connection was
always using its own security session duration, even if the server's
duration was shorter.  Among other potential problems, this was
observed to cause file transfer failures when the starter was
configured with a longer session duration than the shadow.

\item Fixed a bug in the user log writer that was causing the writing
  of events to the global event log fail in some conditions.

\item In the grid universe, submission of nordugrid jobs is now properly
throttled by configuration parameters
\Macro{GRIDMANAGER\_MAX\_SUBMITTED\_JOBS\_PER\_RESOURCE} and
\Macro{GRIDMANAGER\_MAX\_PENDING\_SUBMITS\_PER\_RESOURCE}.

\item The NorduGrid GAHP server can now properly extract job execution
information from newer NorduGrid servers. Previously, the GAHP could crash
when talking to newer servers.

\item Fixed a bug that caused \Condor{config\_val} \Opt{-set} or
  \Opt{-rset} to fail if security negotiation was turned off.
  This happens, for example, if
  \Expr{SEC\_DEFAULT\_NEGOTIATION = NEVER}.
  This bug was introduced in Condor 7.0.0.

\item Fixed a bug that could cause incorrect IP addresses to be advertised
when the \Condor{collector} was on a multi-homed host.

\item Fixed a problem where unexpected ownership and permissions on files
inside a job's working directory could cause the \Condor{starter} to EXCEPT.

\item Improved the speed at which the \Condor{startd} can handle claim
requests, particularly when the \Condor{startd} manages a large number
of slots.

\item Fixed an error in the way the \Condor{procd} calculates image size for
jobs that involve multiple processes. Previously the maximum image size for
any single process was being used. Now the image size sum across all
processes is used.

\item The \Condor{procd} no longer truncates its log file on start up.
  Enabling a log file for the \Condor{procd} is only recommended for
  debugging, since it is not rotated to conserve disk space.

\item Fixed a problem present in Condor 7.0.1 and 7.1.0 where the
\Condor{startd} will crash upon deactivating or releasing a COD claim.

\item Condor on Windows can now correctly handle job image size when
processes are created that allocate more than 2GB of address space.

\item The \Macro{JOB\_INHERITS\_STARTER\_ENVIRONMENT} setting now works when
the \Macro{GLEXEC\_STARTER} feature is in use.

\item Fixed a problem causing \Condor{schedd} to perform poorly when
handling large job queues in which there are any idle local or
scheduler universe jobs (for example, Condor cron jobs).

\item Sped up \Condor{schedd} graceful shutdown when disconnecting
from running jobs that have job leases.  Previously, it would only
disconnect from one such job at a time, so if there were a lot of jobs
running, \Condor{schedd} could take so long to shut down that job leases
expire before it has a chance to restart and reconnect to the jobs.

\item Fixed a bug that could cause incorrect IP addresses to be advertised
when the \Condor{collector} was on a multi-homed host.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-0-1}Version 7.0.1}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Fixed a bug in Condor's authorization policy reader.  The bug
affects cases where the policy (\MacroNI{ALLOW}/\MacroNI{DENY} and
\MacroNI{HOSTALLOW}/\MacroNI{HOSTDENY} settings) mixes host-based
authorizations with authorizations that refer to the authenticated
user name.  In some cases, this bug would result in host-based
settings not being applied to authenticated users.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item Support for Backfill Jobs is now available on Windows platforms.
For more information on this, please see
section~\ref{sec:Backfill-BOINC-Windows} on
page~\pageref{sec:Backfill-BOINC-Windows}.

\item Condor has been ported to Red Hat Enterprise Linux
5.0 running on the 32-bit x86 architecture and on the 64-bit x86\_64
architecture.

% This feature was added in 6.7, but condor_submit wasn't changed.
% Until now, the user had to set this via the '+' notation in the submit
% file.
\item The command \SubmitCmd{email\_attributes} in a job submit
description file defines a set of job ClassAd attributes whose values
should be included in the e-mail notification of job completion.

\item The configuration variable \Macro{CONDOR\_VIEW\_HOST} may now
contain a port number, and may refer to a
\Condor{collector} daemon running on the same host as the
\Condor{collector} that is forwarding ClassAds.  It is also now possible to
use the forwarded ClassAds for matchmaking purposes.  For example, several
\Condor{collector} daemons could forward ClassAds to 
a single aggregating \Condor{collector} daemon which
a \Condor{negotiator} then uses as its source of information for
matchmaking.

\item \Condor{configure} and \Condor{install} now detect missing
  shared libraries (such as \File{libstdc++.so.5} on Linux), and print
  messages and exit if missing libraries are detected.  The new command
  line option \Opt{--ignore-missing-libs} causes it not to exit
  after the messages have been printed, and to proceed with the
  installation.

\item Added a \Opt{--force} command line option to \Condor{configure}
  (and \Condor{install}) which will turn on \Opt{--overwrite} and
  \Opt{--ignore-missing-libs}.

\item \Condor{configure} now writes simple sh and csh shell scripts
  which can be sourced by their respective shells to set the user's
  \Env{PATH} and \Env{CONDOR\_CONFIG} environment variables.  By default, these
  are created in the root of the Condor installation, but this can be
  changed via the \Opt{--env-scripts-dir} command line option.  Also,
  the creation of these scripts can be disabled with the
  \Opt{--no-env-scripts} command line option.

\end{itemize}

\noindent Configuration Variable Additions and Changes:

\begin{itemize}

\item The new configuration variables \Macro{PREEMPTION\_REQUIREMENTS\_STABLE}
  and \Macro{PREEMPTION\_RANK\_STABLE} are boolean values to
  identify whether or not attributes used within the definition of
  \Macro{PREEMPTION\_REQUIREMENTS} and \Macro{PREEMPTION\_RANK} remain
  unchanged during a negotiation cycle.
  See section~\ref{param:PreemptionRequirementsStable} on
  page~\pageref{param:PreemptionRequirementsStable} for 
  complete definitions.

\item The configuration variable \Macro{STARTER\_UPLOAD\_TIMEOUT}
  changed its default value to 300 seconds.

\item The new configuration variable \Macro{CKPT\_PROBE} 
specifies an internal to Condor
executable which determines information about how a process is laid out
in memory, in addition to other information. This executable is not yet
available on Windows platforms.

\item The new configuration variable 
\MacroNI{CKPT\_SERVER\_CHECK\_PARENT\_INTERVAL} sets an interval
of time between checks by the checkpoint server to see if 
its parent, the \Condor{master} daemon, has gone away unexpectedly.
The checkpoint server shuts itself down if this happens.
The default interval for checking is 120 seconds.
Setting this parameter to 0 disables the check.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Upgrade from PCRE v5.0 to PCRE v7.6, due to security vulnerabilities 
found in PCRE v5.0.

\item Fixed file descriptor leak in the \Condor{schedd} when using the SOAP
interface.

\item Fixed a bug that primarily affected pools with
\MacroNI{MaxJobRetirementTime} (0 by default) set larger than
\MacroNI{REQUEST\_CLAIM\_TIMEOUT} (30 minutes by default).  Since
6.9.3, when the \Condor{schedd} timed out requesting a claim to a slot, the
\Condor{startd} was not made aware of the canceled request.  This
resulted in some wasted time (up to \MacroNI{ALIVE\_INTERVAL}) in
which the \Condor{startd} would wait for a job to run.

\item A problem with \Condor{history} in a Quill environment incorrectly
interpreting the \Opt{-name} option has been fixed.

\item A memory leak that prevented \Condor{load\_history} from running
with large history files has been fixed.

\item A bug in \Condor{history} when running in a quill environment has been fixed.  This bug would cause the command to crash in some situations.

\item The job ClassAd attribute \Attr{EmailAttributes} now works 
for grid universe jobs.

\item On 32-bit Linux platforms, the job queue database file may now exceed 2GB.
Previously, the \Condor{schedd} would halt with an error when trying
to write past the 2GB mark.

\item On 32-bit Linux platforms, \Condor{history} can now read from history
files larger than 2GB \emph{except} when using the \Opt{-backwards} option.

\item Local universe jobs are now scheduled to run more promptly.  Previously,
new local universe jobs would sometimes take up to \MacroNI{SCHEDD\_INTERVAL}
(default 5 minutes) to be considered for running.

\item The memory usage of the \Condor{collector} used to grow over time if
daemons with new names kept joining and then leaving the pool
(for example, in a Glidein pool).
This was due to statistics on dropped updates that
accumulated for all daemons that ever advertised themselves to the
\Condor{collector}.  These statistics are now periodically purged of
information about daemons which have not reported in a long time.  How
long is controlled by \Macro{COLLECTOR\_STATS\_SWEEP}, which
defaults to 2 days.

\item Condor daemons would die when trying to send ClassAd
advertisements to a host name that could not be resolved by DNS.

\item Since 6.9.5, file transfer errors for vanilla, java, or parallel
jobs would sometimes not result in the job going on hold as it should.
This was most likely for very small files that failed to be written
for some reason.

\item The \AdAttr{ImageSize} reported for jobs on AIX was too big by a factor
of 1024.

\item Since 6.9.5, \Condor{glidein} failed in the set up stage, due to the
change in syntax of quoting rules
in the Condor submit description file for gt2 argument strings.

\item Fixed a bug in the \Condor{gridmanager} that could prevent refreshed
X509 proxies from being forwarded to the remote machine for grid universe
jobs of type gt4.

\item Fixed a bug in Condor's authorization policy reader.  The bug
affects cases where the policy (\MacroNI{ALLOW}/\MacroNI{DENY} and
\MacroNI{HOSTALLOW}/\MacroNI{HOSTDENY} settings) mixes host-based
authorizations with authorizations that refer to the authenticated
user name.  In some cases, this bug would result in host-based
settings not being applied to authenticated users.

\item Fixed a bug in \Condor{history} which causes a crash 
when \Condor{quill} is enabled.

\item Fixed a problem affecting the GSI and SSL authentication
methods.  When these methods successfully authenticated the user but
failed to find a mapping of the X509 name to a condor user id, they
were setting the authenticated name to \verb|gsi| and \verb|ssl|
respectively.  However, these names contain no domain, so they could
not be referred to in the authorization policy.  Now these anonymous
mappings are \verb|gsi@unmappeduser| and \verb|ssl@unmappeduser|.
Therefore, configuration to deny access by users who are not explicitly mapped
in the map file appears as:

\begin{verbatim}
DENY_READ = *@unmappeduser
DENY_WRITE = *@unmappeduser
\end{verbatim}

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item When using \Condor{compile} with the RHEL5 x86 port of Condor to
produce a standard universe executable, one will see a warning message
about how linking with dynamic libraries is not portable. This warning
is erroneous and should be ignored. It will be fixed in a future version
of Condor.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item The existing configuration variables 
\Macro{SYSTEM\_PERIODIC\_HOLD}, \Macro{SYSTEM\_PERIODIC\_RELEASE}, and
\Macro{SYSTEM\_PERIODIC\_REMOVE} have documented definitions.
See section~\ref{param:SystemPeriodicHold} for definitions.

\item A manual page for \Condor{load\_history} has been added.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-7-0-0}Version 7.0.0}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item PVM support has been dropped.

\item The time zone for the \Prog{PostgreSQL} 8.2 database
  used with Quill on Windows machines must be explicitly set
  to use an abbreviation.
  This Windows environment variable is \verb@TZ@.
  Proper abbreviations for the value of this variable may be found
  within the \Prog{PostgreSQL} installation in a file,
  \File{share/timezonesets/<continent>.txt}, where
  \verb@<continent>@ is replaced by the continent of the 
  desired time zone.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item The Windows MSI installer now supports VM Universe.

\item Eliminated the ``tarball in a tarball'' in our distribution.
  The contents of \File{release.tar} from the distribution tarball
  (for example, \File{condor-6.9.6-linux-x86-centos45-dynamic.tar.gz}) is now
  included in the distribution tarball.

\item Updated \Condor{configure} to match the above change.  The
  \Opt{--install} option now takes a directory path as its parameter,
  for example \Opt{--install=/path/to/release}.
  It previously took the path to
  the \File{release.tar} tarball.

\item Added \Condor{install}, which is a symlink to \Condor{configure}.
  Invoking 
\begin{verbatim}
    condor_install
\end{verbatim}
  is identical to running
\begin{verbatim}
    condor_configure --install=.
\end{verbatim}

\item Added the option \Opt{--prefix=dir} to \Condor{configure} and
  \Condor{install}.  This is an alias for \Opt{--install-dir=dir}.

\item Added the option \Opt{--backup} option to \Condor{configure} and
  \Condor{install}.  This option renames the target \File{sbin} directory,
  if the \Condor{master} daemon exits while in the target \File{sbin} directory.
  Previous versions of \Condor{configure} did this by default.

\item Changed the default behavior of \Condor{install} to exit with a
  warning if the target \File{sbin} directory exists,
  the \Condor{master} daemon is in the \File{sbin} directory,
  and neither the \Opt{--backup} nor \Opt{--overwrite} options are specified.
  This prevents \Condor{install} from improperly moving an \File{sbin}
  directory out of the way.
  For example,
\begin{verbatim}
    condor_install --prefix=/usr
\end{verbatim}
  will not move \File{/usr/sbin} out of the way unless
  the \Opt{--backup} option is also specified.

\item Updated the usage summary of \Condor{configure} and
  \Condor{install} to be much more readable.

\end{itemize}

\noindent Configuration Variable Additions and Changes:

\begin{itemize}

\item The new configuration variable
  \Macro{DEAD\_COLLECTOR\_MAX\_AVOIDANCE\_TIME} defines the maximum
  time in seconds that a daemon will fail over from a primary
  \Condor{collector} to a secondary \Condor{collector}.
  See section~\ref{param:DeadCollectorMaxAvoidanceTime} on
  page~\pageref{param:DeadCollectorMaxAvoidanceTime} for a
  complete definition.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a memory leak in the \Condor{procd} daemon on Windows.

\item Fixed a problem that could cause Condor daemons to crash if a
  failure occurred when communicating with the \Condor{procd}.

\item Fixed a couple of problems that were preventing the
  \Condor{startd} from properly removing per-job directories
  when running with PrivSep.

\item The \Condor{startd} will no longer fail to initialize, 
  claiming the \MacroNI{EXECUTE} directory has improper permissions,
  when PrivSep is enabled.

\item Look ups of ClassAd attribute \Attr{CurrentTime} are now
  case-insensitive, just like all other attributes.

\item Fixed problems causing the following error message in the log file:

\footnotesize
\begin{verbatim}
ERROR: receiving new UDP message but found a short message still waiting to be closed (consumed=1). Closing it now.
\end{verbatim}
\normalsize

\item The existence of the executable given in the submit file is now 
  enforced (when transferring the executable and not using VM 
  universe).

\item The copy of \Condor{dagman} that ships with Condor is now automatically 
  added to the list of trusted programs in the Windows Firewall.

\item Removed \SubmitCmd{remove\_kill\_sig} from the submission file
  generated by \Condor{submit\_dag} on Windows.

\item Fixed the algorithm in the \Condor{negotiator} daemon, which
  with large numbers of machine ClassAds (for example, 10,000) 
  was causing long delays at the 
  beginning of each negotiation cycle.

\item Use of \MacroNI{MAX\_CONCURRENT\_UPLOADS} was resulting in a
  connection attempt from the \Condor{shadow} to the \Condor{schedd} with a
  fixed 10 second timeout, which is sometimes too small.  This timeout
  has been increased to be the same as other connection timeouts between
  the \Condor{shadow} and the \Condor{schedd}, and it now respects
  \MacroNI{SHADOW\_TIMEOUT\_MULTIPLIER}, so it can be adjusted if necessary.

\item Fixed a problem with \Macro{MAX\_CONCURRENT\_UPLOADS} and
  \Macro{MAX\_CONCURRENT\_DOWNLOADS}, which was sometimes allowing
  more than the configured number of concurrent transfers to happen.

\item Fixed a bug in the \Condor{schedd} that could cause it to crash due
  to file descriptor exhaustion when trying to send messages to hundreds of
  \Condor{startd}s simultaneously.

\item Fixed a 6.9.4 bug in the \Condor{startd} that would cause it to crash
  when a BOINC backfill job exited.

\item Since 6.9.4, when using glExec, configuring \MacroNI{SLOT<N>\_EXECUTE}
  would cause \Condor{starter} to fail when starting the job.

\item Fixed a bug from 6.9.5 which caused authentication failure for
  the pool password authentication method.

\item Fixed a bug that caused Condor daemons to crash when encountering
  some types of invalid ClassAd expressions.

\item Fixed a bug under Linux that could cause multi-process daemons
  lacking a log lock file to crash while rotating logs that have reached
  their maximum configured size.

\item Fixed a bug under Windows that sometimes caused connection attempts
  between Condor daemons to fail with Windows error number 10056.

\item Fixed a problem in which there are multiple 
  \Condor{collector} daemons in a pool
  for fault tolerance.  If the primary \Condor{collector} failed, the
  \Condor{negotiator} would fail over to the secondary \Condor{collector}
  indefinitely (or until the secondary \Condor{collector} also failed or the
  administrator ran \Condor{reconfig}).  This was a problem for users
  flocking jobs to the pool, because flocking currently only works with
  the primary \Condor{collector}.  Now, the \Condor{negotiator} will fail over
  for a restricted amount of time, up to
  \Macro{DEAD\_COLLECTOR\_MAX\_AVOIDANCE\_TIME} seconds.  The default
  is one hour, but if querying the dead primary \Condor{collector}
  takes very little
  time to fail, the \Condor{negotiator} may retry more frequently
  in order to remain
  responsive to flocked users.

\item Fixed a problem preventing the use of \Condor{q} \Opt{-analyze}
  with the \Opt{-pool} option.

\item Fixed a problem in the \Condor{negotiator} in which machines go
  unassigned when user priorities result in the machines getting split
  into shares that are rounded down to 0.  For example if there are 10
  machines and 100 equal priority submitters, then each submitter was
  getting 0.1 machines, which got rounded down to 0, so no machines were
  assigned to anybody.  The message in the \Condor{negotiator} log in this case
  was this:

\footnotesize
\begin{verbatim}
Over submitter resource limit (0) ... only consider startd ranks
\end{verbatim}
\normalsize

\item Fixed a problem introduced in 6.9.3 that would cause daemons to
  run out of file descriptors if they create sub-processes and are
  configured to use a lock file for the debug log.

\item Standard universe jobs now work properly when using PrivSep.

\item Fixed problem with PrivSep mode where a job that dumps core would
  not get the core file transferred back to the the submit host if the
  \SubmitCmd{transfer\_output\_files} submit option were used.

\item Fixed a bug that caused the \Condor{starter} to crash if a job
called \Condor{chirp} with the \Expr{get\_job\_attr} option.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}

